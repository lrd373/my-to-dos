(()=>{"use strict";const e=(e,t)=>{let n="";return e&&(n+=e.charAt(0)),t&&(n+=t.charAt(0)),n+=Math.ceil(1e4*Math.random())*Math.ceil(1e4*Math.random()),n},t=e=>{var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},n=(()=>{let n=[],o={id:e("m"),name:"My To-Dos",list:[]};t("localStorage")&&localStorage.getItem("projects")?(console.log("Local storage available"),n=JSON.parse(localStorage.getItem("projects"))):console.log("No local storage available");const d=()=>{console.log("trying to set local storage"),t("localStorage")&&localStorage.setItem("projects",JSON.stringify(n))},c=e=>n.find((t=>t.id==e));return{setLocalStorage:d,getProject:c,getProjects:()=>n,addProject:(t,o)=>{let i;i=o||e(t);let l={id:i,name:t,list:[]};n.push(l),d(),r()},deleteProject:e=>{let t=n.findIndex((t=>t.id==e));n.splice(t,1),d(),r()},getCurrentProject:()=>o,setCurrentProject:e=>{o=c(e),l(o.name),document.querySelector("#delete-project-button").style.display="mytodos"===e?"none":"inline",r(),i()}}})(),o=(()=>{const t=()=>n.getCurrentProject().list;return{addToList:(o,r,l,d)=>{let c=((t,n,o,r)=>({itemId:e(t,n),itemTitle:t,itemDescription:n,itemDueDate:o,itemPriority:r}))(o,r,l,d);t().push(c),console.log("Updated project"),console.log(n.getCurrentProject()),n.setLocalStorage(),i()},removeFromList:e=>{let o=t().findIndex((t=>t.itemId==e));console.log(),-1!==o&&t().splice(o,1),n.setLocalStorage(),i()},getList:t}})(),r=()=>{const e=document.querySelector("header");let t=document.querySelector("#project-button-container");if(t)for(;t.firstChild;)t.removeChild(t.firstChild);else t=document.createElement("div"),t.setAttribute("id","project-button-container");n.getProjects().forEach((e=>{e!=n.getCurrentProject()&&(e=>{let o=document.createElement("button");o.classList.add("project-button"),o.setAttribute("type","button"),o.textContent=e.name,o.addEventListener("click",(()=>{n.setCurrentProject(e.id)})),t.appendChild(o)})(e)})),e.appendChild(t)},i=()=>{const e=document.querySelector("#content");let t=document.querySelector("#list-container");if(t)for(;t.firstChild;)console.log("tried to empty list"),t.removeChild(t.firstChild);else t=document.createElement("div");t.setAttribute("id","list-container");let n=o.getList();console.log("What display thinks is current list:"),console.log(n),n.forEach((e=>{t.appendChild((e=>{let t=e.itemId,n=e.itemTitle,r=e.itemDescription,i=e.itemDueDate,l=e.itemPriority,d=document.createElement("div");d.classList.add("list-item-container"),d.setAttribute("id",t);let c=document.createElement("button");c.classList.add("remove-item-button"),c.textContent="x",c.addEventListener("click",(()=>{o.removeFromList(t)}));let a=document.createElement("div");a.classList.add("item-text-div");let s=document.createElement("h3");s.classList.add("list-item-title"),s.textContent=n;let u=document.createElement("p");u.classList.add("list-item-description"),u.textContent=r,a.appendChild(s),a.appendChild(u);let m=document.createElement("p");m.classList.add("list-item-duedate"),m.textContent=i;let p=document.createElement("p");return p.classList.add("list-item-priority"),p.textContent=`Priority: ${l}`,d.appendChild(c),d.appendChild(a),d.appendChild(m),d.appendChild(p),d})(e))})),e.appendChild(t)},l=e=>{document.querySelector("h1").textContent=e},d=(()=>{const e=document.querySelector("#content");let t=document.createElement("div");t.setAttribute("id","form-container");const n=()=>{t.style.display="none"};return{generateForm:()=>{let r=document.createElement("form"),i=document.createElement("button");i.setAttribute("id","form-exit-button"),i.textContent="x",i.addEventListener("click",n),r.appendChild(i);let l=document.createElement("label");l.setAttribute("for","title-input"),l.textContent="Title";let c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("id","title-input"),r.appendChild(l),r.appendChild(c);let a=document.createElement("label");a.setAttribute("for","description-input"),a.textContent="Description";let s=document.createElement("textarea");s.setAttribute("id","description-input"),r.appendChild(a),r.appendChild(s);let u=document.createElement("label");u.setAttribute("for","due-date"),u.textContent="Due Date";let m=document.createElement("input");m.setAttribute("id","due-date"),m.setAttribute("type","date"),r.appendChild(u),r.appendChild(m);let p=document.createElement("label");p.setAttribute("for","priority"),p.setAttribute("id","priority-label"),p.textContent="Priority";let C=document.createElement("select");C.setAttribute("id","priority"),C.setAttribute("name","priority");let h=document.createElement("option");h.setAttribute("value","high"),h.textContent="High";let b=document.createElement("option");b.setAttribute("value","medium"),b.textContent="Medium";let E=document.createElement("option");E.setAttribute("value","low"),E.textContent="Low",C.appendChild(h),C.appendChild(b),C.appendChild(E),r.appendChild(p),r.appendChild(C);let g=document.createElement("button");g.setAttribute("type","button"),g.textContent="Add to list",g.addEventListener("click",(()=>{o.addToList(c.value,s.value,m.value,C.value),d.closeForm()})),r.appendChild(g),t.appendChild(r),e.appendChild(t)},launchForm:()=>{t.style.display="block"},closeForm:n}})(),c=(()=>{const e=document.querySelector("#content");let t=document.createElement("div");t.setAttribute("id","project-form-container");const o=()=>{t.style.display="none"};return{generateForm:()=>{let r=document.createElement("form"),i=document.createElement("button");i.setAttribute("id","form-exit-button"),i.textContent="x",i.addEventListener("click",o),r.appendChild(i);let l=document.createElement("label");l.setAttribute("for","name-input"),l.textContent="Project Name";let d=document.createElement("input");d.setAttribute("type","text"),d.setAttribute("id","name-input"),r.appendChild(l),r.appendChild(d);let a=document.createElement("button");a.setAttribute("type","button"),a.textContent="Create project",a.addEventListener("click",(()=>{n.addProject(d.value),console.log(n.getProjects()),c.closeForm()})),r.appendChild(a),t.appendChild(r),e.appendChild(t)},launchForm:()=>{t.style.display="block"},closeForm:o}})(),a=document.querySelector("#content");(()=>{d.generateForm();let e=document.createElement("header"),t=document.createElement("div");t.setAttribute("id","header-container");let o=document.createElement("h1");o.textContent="My To-Dos",t.appendChild(o);let r=document.createElement("button");r.setAttribute("id","add-button"),r.textContent="+",r.addEventListener("click",(()=>{d.launchForm()})),t.appendChild(r);let i=document.createElement("button");i.textContent="Delete this project",i.setAttribute("id","delete-project-button"),i.addEventListener("click",(()=>{let e=n.getCurrentProject().id;if("mytodos"!==e){n.deleteProject(e);let t=n.getProjects()[0].id;n.setCurrentProject(t)}})),t.appendChild(i),e.appendChild(t),c.generateForm();let l=document.createElement("button");l.setAttribute("id","add-project-button"),l.textContent="+",l.addEventListener("click",(()=>{c.launchForm()})),e.appendChild(l),a.appendChild(e)})(),r(),i()})();