(()=>{"use strict";const e=(e,t)=>{let n="";return e&&(n+=e.charAt(0)),t&&(n+=t.charAt(0)),n+=Math.ceil(1e4*Math.random())*Math.ceil(1e4*Math.random()),n},t=e=>{var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},n=(()=>{let n=[],o={id:e("m"),name:"My To-Dos",list:[]};t("localStorage")&&localStorage.getItem("projects")?(console.log("Local storage available"),n=JSON.parse(localStorage.getItem("projects"))):console.log("No local storage available");const l=()=>{console.log("trying to set local storage"),t("localStorage")&&(localStorage.setItem("projects",JSON.stringify(n)),console.log("local storage updated successfully"))},d=e=>n.find((t=>t.id==e)),r=()=>n;return{setLocalStorage:l,getProject:d,getProjects:r,addProject:(t,o)=>{let d;d=o||e(t);let r={id:d,name:t,list:[]};n.push(r),l(),i()},deleteProject:e=>{let t=n.findIndex((t=>t.id==e));n.splice(t,1),l(),i()},getCurrentProject:()=>o,setCurrentProject:e=>{o=d(e),a(o.name),document.querySelector("#delete-project-button").style.display="mytodos"===e?"none":"inline",i(),c()},projectInList:e=>-1!==r().findIndex((t=>t.id=e))}})(),o=(()=>{const t=()=>n.getCurrentProject().list;return{addToList:(o,l,d)=>{let r=((t,n,o,l)=>({itemId:e(t,n),itemTitle:t,itemDescription:n,itemDueDate:o}))(o,l,d);t().push(r),console.log("Updated project"),console.log(n.getCurrentProject()),n.setLocalStorage(),c()},removeFromList:e=>{let o=t().findIndex((t=>t.itemId==e));-1!==o&&t().splice(o,1),n.setLocalStorage(),c()},getList:t}})(),l=(()=>{const e=document.querySelector("#content");let t=document.createElement("div");t.setAttribute("id","form-container");const n=()=>{t.style.display="none"},d=(e,t,n)=>{let o=document.querySelector("#title-input"),l=document.querySelector("#description-input"),d=document.querySelector("#due-date");o&&l&&d&&(o.value=e,l.value=t,d.value=n)};return{generateForm:()=>{let r=document.createElement("form");r.setAttribute("id","new-list-item-form");let i=document.createElement("button");i.setAttribute("id","form-exit-button"),i.textContent="x",i.addEventListener("click",(()=>{d("","",""),n()})),r.appendChild(i);let c=document.createElement("label");c.setAttribute("for","title-input"),c.textContent="Title";let a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("id","title-input"),r.appendChild(c),r.appendChild(a);let s=document.createElement("label");s.setAttribute("for","description-input"),s.textContent="Description";let u=document.createElement("textarea");u.setAttribute("id","description-input"),r.appendChild(s),r.appendChild(u);let m=document.createElement("label");m.setAttribute("for","due-date"),m.textContent="Due Date";let p=document.createElement("input");p.setAttribute("id","due-date"),p.setAttribute("type","date"),r.appendChild(m),r.appendChild(p);let h=document.createElement("button");h.setAttribute("type","button"),h.textContent="Add to list",h.addEventListener("click",(()=>{o.addToList(a.value,u.value,p.value),l.closeForm(),d("","","")})),r.appendChild(h),t.appendChild(r),e.appendChild(t)},launchForm:()=>{t.style.display="block"},closeForm:n,setFormValues:d}})(),d=(()=>{const e=document.querySelector("#content");let t=document.createElement("div");t.setAttribute("id","project-form-container");const o=()=>{t.style.display="none"};return{generateForm:()=>{let l=document.createElement("form"),r=document.createElement("button");r.setAttribute("id","form-exit-button"),r.textContent="x",r.addEventListener("click",o),l.appendChild(r);let i=document.createElement("label");i.setAttribute("for","name-input"),i.textContent="Project Name";let c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("id","name-input"),l.appendChild(i),l.appendChild(c);let a=document.createElement("button");a.setAttribute("type","button"),a.textContent="Create project",a.addEventListener("click",(()=>{n.addProject(c.value),console.log(n.getProjects()),d.closeForm()})),l.appendChild(a),t.appendChild(l),e.appendChild(t)},launchForm:()=>{t.style.display="block"},closeForm:o}})(),r=document.querySelector("#content"),i=()=>{let e=document.querySelector("#project-button-container");if(e)for(;e.childNodes.length>1;)e.removeChild(e.lastChild);else{e=document.createElement("div"),e.setAttribute("id","project-button-container");let t=document.createElement("button");t.setAttribute("id","add-project-button"),t.textContent="+",t.addEventListener("click",(()=>{d.launchForm()})),e.appendChild(t)}n.getProjects().forEach((t=>{t!=n.getCurrentProject()&&(t=>{let o=document.createElement("button");o.classList.add("project-button"),o.setAttribute("type","button"),o.textContent=t.name,o.addEventListener("click",(()=>{n.setCurrentProject(t.id)})),e.appendChild(o)})(t)})),r.appendChild(e)},c=()=>{let e=document.querySelector("#list-container");if(e)for(;e.childNodes.length>1;)e.firstChild.remove();else{e=document.createElement("div"),e.setAttribute("id","list-container");let t=document.createElement("button");t.setAttribute("id","add-button"),t.textContent="+ Add Task",t.addEventListener("click",(()=>{l.launchForm()})),e.appendChild(t)}let t=document.querySelector("#add-button"),n=o.getList();t&&n.forEach((e=>{t.before((e=>{let t=e.itemId,n=e.itemTitle,d=new Date(e.itemDueDate),r=e.itemDescription,i=document.createElement("div");i.classList.add("list-item-container"),i.setAttribute("id",t);let c=document.createElement("p");c.classList.add("list-item-description"),c.textContent=r;let a=document.createElement("div");a.classList.add("item-title-container");let s=document.createElement("h3");if(s.classList.add("list-item-title"),s.textContent=n,a.appendChild(s),r){let e=document.createElement("button");e.classList.add("toggle-description"),e.textContent="üî∫",e.addEventListener("click",(()=>{e.classList.contains("spin-and-reveal")?(e.classList.remove("spin-and-reveal"),c.style.display="none"):(e.classList.add("spin-and-reveal"),c.style.display="inline-block")})),a.appendChild(e)}let u=document.createElement("span");u.classList.add("item-checkbox"),u.addEventListener("click",(()=>{s.classList.contains("checked")?(s.classList.remove("checked"),u.textContent=""):(s.classList.add("checked"),u.textContent="‚úîÔ∏è")}));let m=document.createElement("p");m.classList.add("list-item-duedate"),e.itemDueDate&&(m.textContent=`Due: ${d.toLocaleDateString()}`);let p=document.createElement("div");p.classList.add("item-button-container");let h=document.createElement("button");h.classList.add("remove-item-button"),h.innerHTML="<img src='images/trash.png' alt='Edit list item'>",h.addEventListener("click",(()=>{o.removeFromList(t)}));let C=document.createElement("button");return C.classList.add("edit-item-button"),C.innerHTML="<img src='images/edit.png' alt='Delete list item'>",C.addEventListener("click",(()=>{l.setFormValues(n,r,d),l.launchForm(),o.removeFromList(t)})),p.appendChild(C),p.appendChild(h),i.appendChild(u),i.appendChild(a),i.appendChild(m),i.appendChild(p),i.appendChild(c),i})(e))})),r.appendChild(e)},a=e=>{document.querySelector("h1").textContent=e},s=document.querySelector("#content");(()=>{l.generateForm();let e=document.createElement("header"),t=document.createElement("div");t.setAttribute("id","header-container");let o=document.createElement("h1");t.appendChild(o);let r=document.createElement("button");r.textContent="Delete this project",r.setAttribute("id","delete-project-button"),r.addEventListener("click",(()=>{let e=n.getCurrentProject().id;if("mytodos"!==e){n.deleteProject(e);let t=n.getProjects()[0].id;n.setCurrentProject(t)}})),t.appendChild(r),e.appendChild(t),d.generateForm(),s.appendChild(e)})(),!1===n.projectInList("mytodos")&&n.addProject("My To-Dos","mytodos"),n.setCurrentProject("mytodos"),console.log("Projects at first load:"),console.log(n.getProjects()),console.log("Current project at first load:"),console.log(n.getCurrentProject()),c(),i()})();