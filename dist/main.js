(()=>{"use strict";const e=(e,t)=>{let n="";if(e&&(n+=e.charAt(0)),t&&(n+=t.charAt(0)),!e&&!t){let e=Math.ceil(26*Math.random())+64;n+=String.fromCharCode(e)}return n+=Math.ceil(1e4*Math.random())*Math.ceil(1e4*Math.random()),n},t=e=>{var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},n=(()=>{let n=[],l={id:e("m"),name:"My To-Dos",list:[]};t("localStorage")&&localStorage.getItem("projects")?(console.log("Local storage available"),n=JSON.parse(localStorage.getItem("projects"))):console.log("No local storage available");const i=()=>{console.log("trying to set local storage"),t("localStorage")&&(localStorage.setItem("projects",JSON.stringify(n)),console.log("local storage updated successfully"))},d=e=>n.find((t=>t.id==e)),o=()=>n;return{setLocalStorage:i,getProject:d,getProjects:o,addProject:(t,l)=>{let d;d=l||e(t);let o={id:d,name:t,list:[]};n.push(o),i(),s()},deleteProject:e=>{let t=n.findIndex((t=>t.id==e));n.splice(t,1),i(),s()},getCurrentProject:()=>l,setCurrentProject:e=>{l=d(e),c(l.name),document.querySelector("#delete-project-button").style.display="mytodos"===e?"none":"inline",s(),a()},projectInList:e=>-1!==o().findIndex((t=>t.id=e))}})(),l=(()=>{const t=()=>n.getCurrentProject().list;return{addToList:(l,i,d)=>{let o=((t,n,l,i)=>({itemId:e(t,n),itemTitle:t,itemDescription:n,itemDueDate:l}))(l,i,d);t().push(o),console.log("Updated project"),console.log(n.getCurrentProject()),n.setLocalStorage(),a()},removeFromList:e=>{let l=t().findIndex((t=>t.itemId==e));-1!==l&&t().splice(l,1),n.setLocalStorage(),a()},getList:t}})(),i=(()=>{const e=document.querySelector("#content");let t=document.createElement("div");t.setAttribute("id","form-container");const n=()=>{t.style.display="none"},d=(e,t,n)=>{let l=document.querySelector("#title-input"),i=document.querySelector("#description-input"),d=document.querySelector("#due-date");l&&i&&d&&(l.value=e,i.value=t,d.value=n)};return{generateForm:()=>{let o=document.createElement("form");o.setAttribute("id","new-list-item-form");let a=document.createElement("div");a.classList.add("form-content-container");let s=document.createElement("button");s.classList.add("form-exit-button"),s.textContent="❌",s.addEventListener("click",(()=>{d("","",""),n()})),a.appendChild(s);let c=document.createElement("label");c.setAttribute("for","title-input"),c.textContent="Title";let r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("id","title-input"),a.appendChild(c),a.appendChild(r);let u=document.createElement("label");u.setAttribute("for","description-input"),u.textContent="Description";let m=document.createElement("textarea");m.setAttribute("id","description-input"),a.appendChild(u),a.appendChild(m);let p=document.createElement("label");p.setAttribute("for","due-date"),p.textContent="Due Date";let y=document.createElement("input");y.setAttribute("id","due-date"),y.setAttribute("type","date"),a.appendChild(p),a.appendChild(y);let b=document.createElement("button");b.setAttribute("type","button"),b.classList.add("form-submit-button"),b.classList.add("submit-button"),b.textContent="+ Add to list",b.addEventListener("click",(()=>{l.addToList(r.value,m.value,y.value),i.closeForm(),d("","","")})),a.appendChild(b),o.appendChild(a),t.appendChild(o),e.appendChild(t)},launchForm:()=>{t.style.display="block"},closeForm:n,setFormValues:d}})(),d=(()=>{const e=document.querySelector("#content");let t=document.createElement("div");t.setAttribute("id","project-form-container");const l=()=>{t.style.display="none",document.querySelector("#name-input").value=""};return{generateForm:()=>{let i=document.createElement("form"),o=document.createElement("button");o.classList.add("form-exit-button"),o.textContent="❌",o.addEventListener("click",l),i.appendChild(o);let a=document.createElement("label");a.setAttribute("for","name-input"),a.textContent="Project Name";let s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("id","name-input"),i.appendChild(a),i.appendChild(s);let c=document.createElement("button");c.setAttribute("type","button"),c.classList.add("form-submit-button"),c.classList.add("submit-button"),c.textContent="Create project",c.addEventListener("click",(()=>{n.addProject(s.value),d.closeForm()})),i.appendChild(c),t.appendChild(i),e.appendChild(t)},launchForm:()=>{t.style.display="block"},closeForm:l}})(),o=document.querySelector("#content"),a=()=>{let e=document.querySelector("#list-container");if(e)for(;e.childNodes.length>1;)e.firstChild.remove();else{e=document.createElement("div"),e.setAttribute("id","list-container");let t=document.createElement("button");t.setAttribute("id","add-button"),t.classList.add("submit-button"),t.textContent="+ Add Item",t.addEventListener("click",(()=>{i.launchForm()})),e.appendChild(t)}let t=document.querySelector("#add-button"),n=l.getList();t&&n.forEach((e=>{t.before((e=>{let t=e.itemId,n=e.itemTitle,i=new Date(e.itemDueDate),d=e.itemDescription,o=document.createElement("div");o.classList.add("list-item-container"),o.setAttribute("id",t);let a=document.createElement("div");a.classList.add("item-title-container");let s=document.createElement("h3");s.classList.add("list-item-title"),s.textContent=n,a.appendChild(s);let c=document.createElement("button");c.classList.add("toggle-description"),c.textContent="🔺",c.addEventListener("click",(()=>{c.classList.contains("spin-and-reveal")?(c.classList.remove("spin-and-reveal"),E.style.display="none",h.style.display="none"):(c.classList.add("spin-and-reveal"),E.style.display="inline-block",h.style.display="inline-block")})),c.style.display=d?"inline":"none",a.appendChild(c);let r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("value",`${s.textContent}`),r.style.display="none",a.appendChild(r);let u=document.createElement("span");u.classList.add("item-checkbox"),u.addEventListener("click",(()=>{s.classList.contains("checked")?(s.classList.remove("checked"),u.textContent="",u.style.backgroundColor="#668658"):(s.classList.add("checked"),u.textContent="✔️",u.style.backgroundColor="rgb(37, 51, 38)")}));let m=document.createElement("div");m.classList.add("duedate-container");let p=document.createElement("p");p.textContent="Due: ";let y=document.createElement("p");y.classList.add("list-item-duedate"),e.itemDueDate&&(y.textContent=i.toLocaleDateString(),m.appendChild(p)),m.appendChild(y);let b=document.createElement("input");b.setAttribute("type","date"),b.style.display="none",m.appendChild(b);let C=document.createElement("div");C.classList.add("description-container");let h=document.createElement("img");h.setAttribute("src","images/curve-arrow.png"),h.classList.add("list-item-icon");let E=document.createElement("p");E.classList.add("list-item-description"),E.textContent=d,C.appendChild(h),C.appendChild(E);let g=document.createElement("textarea");g.setAttribute("value",`${E.textContent}`),g.setAttribute("rows","5"),g.setAttribute("cols","50"),g.style.display="none",C.appendChild(g);let L=document.createElement("div");L.classList.add("item-button-container");let v=document.createElement("button");v.classList.add("submit-edits-button"),v.classList.add("submit-button"),v.textContent="Submit",v.style.display="none",v.addEventListener("click",(()=>{A()}));let j=document.createElement("button");j.classList.add("remove-item-button"),j.classList.add("img-button"),j.innerHTML="<img src='images/trash.png' alt='Edit list item'>",j.addEventListener("click",(()=>{l.removeFromList(t)}));let x=document.createElement("button");x.classList.add("edit-item-button"),x.classList.add("img-button"),x.innerHTML="<img src='images/edit.png' alt='Delete list item'>",x.addEventListener("click",(()=>{A()})),L.appendChild(v),L.appendChild(x),L.appendChild(j),o.appendChild(u),o.appendChild(a),o.appendChild(m),o.appendChild(L),o.appendChild(C);const A=()=>{if("none"!==v.style.display){if(s.textContent=r.value,s.style.display="inline",c.style.display="inline",r.style.display="none",b.value){let e=new Date(b.value);y.textContent=e.toLocaleDateString()}else y.textContent="";p.style.display="inline",y.style.display="inline",b.style.display="none",x.style.display="inline",j.style.display="inline",v.style.display="none",E.textContent=g.value,E.style.display="none",g.value?c.style.display="inline":c.style.display="none",g.style.display="none"}else s.style.display="none",c.style.display="none",r.style.display="inline",p.style.display="none",y.style.display="none",b.style.display="inline",x.style.display="none",j.style.display="none",v.style.display="inline",E.style.display="none",g.style.display="inline"};return o})(e))})),o.appendChild(e)},s=()=>{let e=document.querySelector("#project-button-container");if(e)for(;e.childNodes.length>1;)e.removeChild(e.lastChild);else{e=document.createElement("div"),e.setAttribute("id","project-button-container");let t=document.createElement("button");t.setAttribute("id","add-project-button"),t.classList.add("submit-button"),t.textContent="+ Add Project",t.addEventListener("click",(()=>{d.launchForm()})),e.appendChild(t)}let t=n.getProjects();if(t.length>1){let t=document.createElement("h2");t.setAttribute("id","my-projects"),t.textContent="My Projects",e.appendChild(t);let n=document.createElement("hr");n.setAttribute("id","projects-divider"),e.appendChild(n)}t.forEach((t=>{t!=n.getCurrentProject()&&(t=>{let l=document.createElement("button");l.classList.add("project-button"),l.setAttribute("type","button"),l.textContent=t.name,l.addEventListener("click",(()=>{n.setCurrentProject(t.id)})),e.appendChild(l)})(t)})),o.appendChild(e)},c=e=>{document.querySelector("h1").textContent=e},r=document.querySelector("#content");(()=>{i.generateForm();let e=document.createElement("header"),t=document.createElement("div");t.setAttribute("id","header-container");let l=document.createElement("h1");t.appendChild(l);let o=document.createElement("button");o.textContent="Delete this project",o.setAttribute("id","delete-project-button"),o.classList.add("submit-button"),o.addEventListener("click",(()=>{let e=n.getCurrentProject().id;if("mytodos"!==e){n.deleteProject(e);let t=n.getProjects()[0].id;n.setCurrentProject(t)}})),t.appendChild(o),e.appendChild(t),d.generateForm(),r.appendChild(e)})(),!1===n.projectInList("mytodos")&&n.addProject("My To-Dos","mytodos"),n.setCurrentProject("mytodos"),console.log("Projects at first load:"),console.log(n.getProjects()),console.log("Current project at first load:"),console.log(n.getCurrentProject()),a(),s()})();